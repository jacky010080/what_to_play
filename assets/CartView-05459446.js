import{_ as f,f as x,r as v,o as l,c as i,d as t,F as p,g as m,j as w,t as d,a as y,w as $,b,k as T,v as I}from"./index-2d8cb76f.js";import{S as c}from"./sweetalert2.all-85980b94.js";const{VITE_API:h,VITE_APIPATH:u}={VITE_API:"https://vue3-course-api.hexschool.io/",VITE_APIPATH:"jacky010080",BASE_URL:"/what_to_play/",MODE:"production",DEV:!1,PROD:!0},k={data(){return{products:[],productId:"",cart:{},loadingItem:""}},components:{RouterLink:x},methods:{getCart(){this.$http.get(`${h}/v2/api/${u}/cart`).then(e=>{this.cart=e.data.data}).catch(e=>{c.fire({icon:"error",title:`錯誤 ${e.response.status}`,text:e.response.data.message,confirmButtonText:"OK"})})},updateProductQty(e){const o={product_id:e.product.id,qty:e.qty};this.loadingItem=e.id,this.$http.put(`${h}/v2/api/${u}/cart/${e.id}`,{data:o}).then(r=>{this.getCart(),this.loadingItem="",c.fire({icon:"success",title:r.data.message,confirmButtonText:"OK"})}).catch(r=>{this.loadingItem="",c.fire({icon:"error",title:`錯誤 ${r.response.status}`,text:r.response.data.message,confirmButtonText:"OK"})})},deleteProduct(e){this.loadingItem=e.id,this.$http.delete(`${h}/v2/api/${u}/cart/${e.id}`).then(o=>{this.getCart(),this.loadingItem="",c.fire({icon:"success",title:o.data.message,confirmButtonText:"OK"})}).catch(o=>{c.fire({icon:"error",title:`錯誤 ${o.response.status}`,text:o.response.data.message,confirmButtonText:"OK"})})},deleteAllProduct(){this.$http.delete(`${h}/v2/api/${u}/carts`).then(e=>{this.getCart(),c.fire({icon:"success",title:e.data.message,confirmButtonText:"OK"})}).catch(e=>{c.fire({icon:"error",title:`錯誤 ${e.response.status}`,text:e.response.data.message,confirmButtonText:"OK"})})}},mounted(){this.getCart()}},C={class:"container"},P={class:"mt-3"},V=t("h3",{class:"mt-3 mb-4"},"購物車",-1),B={class:"row"},O={class:"col-md-8"},A={class:"table"},E=t("thead",null,[t("tr",null,[t("th"),t("th",{scope:"col",class:"border-0 ps-0"},"品名"),t("th",{scope:"col",class:"border-0"},"數量"),t("th",{scope:"col",class:"border-0"},"單價")])],-1),K={class:"border-0 align-middle"},N=["onClick","disabled"],D=t("i",{class:"fas fa-spinner fa-pulse"},null,-1),S={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},j=["src"],q={class:"mb-0 fw-bold ms-3 d-inline-block"},U={class:"border-0 align-middle"},L={class:"input-group input-group-sm"},R=["onUpdate:modelValue","onChange","disabled"],F=["value"],H={class:"border-0 align-middle"},M={class:"mb-0 ms-auto"},Q={class:"col-md-4"},z={class:"border p-4 mb-4"},G=t("h4",{class:"fw-bold mb-4"},"Order Detail",-1),J={class:"table text-muted border-bottom"},W=t("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"Subtotal",-1),X={class:"text-end border-0 px-0 pt-4"},Y={class:"d-flex justify-content-between mt-4"},Z=t("p",{class:"mb-0 h4 fw-bold"},"Total",-1),tt={class:"mb-0 h4 fw-bold"};function et(e,o,r,st,n,_){const g=v("router-link");return l(),i("div",C,[t("div",P,[t("button",{type:"button",class:"btn btn-outline-warning",onClick:o[0]||(o[0]=s=>_.deleteAllProduct())},"清空購物車"),V,t("div",B,[t("div",O,[t("table",A,[E,t("tbody",null,[n.cart.carts?(l(!0),i(p,{key:0},m(n.cart.carts,s=>(l(),i("tr",{key:s.id,class:"border-bottom border-top"},[t("td",K,[t("button",{type:"button",class:"btn btn-outline-warning btn-sm",onClick:a=>_.deleteProduct(s),disabled:s.id===n.loadingItem},[D,b(" x ")],8,N)]),t("td",S,[t("img",{src:s.product.imageUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,j),t("p",q,d(s.product.title),1)]),t("td",U,[t("div",L,[T(t("select",{name:"",id:"",class:"form-control","onUpdate:modelValue":a=>s.qty=a,onChange:a=>_.updateProductQty(s),disabled:s.id===n.loadingItem},[(l(),i(p,null,m(20,a=>t("option",{value:a,key:"cart"+a},d(a),9,F)),64))],40,R),[[I,s.qty]])])]),t("td",H,[t("p",M,"NT$"+d(s.total),1)])]))),128)):w("",!0)])])]),t("div",Q,[t("div",z,[G,t("table",J,[t("tbody",null,[t("tr",null,[W,t("td",X,"NT$"+d(n.cart.total),1)])])]),t("div",Y,[Z,t("p",tt,"NT$"+d(n.cart.total),1)]),y(g,{to:"/checkout",class:"btn btn-primary w-100 mt-4"},{default:$(()=>[b("確認購買")]),_:1})])])])])])}const ct=f(k,[["render",et]]);export{ct as default};
