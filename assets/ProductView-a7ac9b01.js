import{S as l}from"./sweetalert2.all-23090308.js";import{_ as x,r as f,o as p,a as _,b as t,d as r,w as u,t as n,h as v,j as w,v as T,F as L,g as P,f as h}from"./index-c9dccfb6.js";const{VITE_API:m,VITE_APIPATH:g}={VITE_API:"https://vue3-course-api.hexschool.io/",VITE_APIPATH:"whattoplay",BASE_URL:"/what_to_play/",MODE:"production",DEV:!1,PROD:!0},k={emits:["refreshCart"],data(){return{product:{},products:[],isLoading:!1}},methods:{getTargetProduct(){const{id:c}=this.$route.params;this.isLoading=!0,this.$http.get(`${m}/v2/api/${g}/product/${c}`).then(s=>{this.isLoading=!1,this.product=s.data.product,this.product.qty=1,this.product.origin_price=this.product.origin_price.toLocaleString(),this.product.price=this.product.price.toLocaleString(),this.getProducts()}).catch(s=>{this.isLoading=!1,l.fire({icon:"error",title:`錯誤 ${s.response.status}`,text:s.response.data.message,confirmButtonText:"OK"})})},getProducts(c=1){this.isLoading=!0,this.$http.get(`${m}/v2/api/${g}/products/?page=${c}`).then(s=>{this.isLoading=!1;for(const i of s.data.products)if(i.id!==this.product.id&&i.category===this.product.category&&this.products.push(i),this.products.length>=3)break}).catch(s=>{this.isLoading=!1,l.fire({icon:"error",title:`錯誤 ${s.response.status}`,text:s.response.data.message,confirmButtonText:"OK"})})},addToCart(c){const s={product_id:c,qty:this.product.qty};this.isLoading=!0,this.$http.post(`${m}/v2/api/${g}/cart`,{data:s}).then(i=>{this.isLoading=!1,this.product.qty=1,l.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3}).fire({icon:"success",title:i.data.message}),this.$emit("refreshCart")}).catch(i=>{this.isLoading=!1,l.fire({icon:"error",title:`錯誤 ${i.response.status}`,text:i.response.data.message,confirmButtonText:"OK"})})},goToProduct(c){this.$router.push(`/product/${c}`).then(()=>{location.reload()})},qtyPlus(){this.product.qty++},qtyMinus(){this.product.qty--}},mounted(){this.getTargetProduct()}},C={class:"container my-5"},q={class:"row justify-content-center align-items-center"},$={class:"col-md-6"},V={id:"carouselExampleControls",class:"carousel slide","data-ride":"carousel"},E={class:"carousel-inner"},I={class:"carousel-item active"},j=["src"],B={class:"col-md-4"},S={"aria-label":"breadcrumb"},A={class:"breadcrumb bg-white px-0 mb-0 py-3"},N={class:"breadcrumb-item"},D={class:"breadcrumb-item"},M=t("li",{class:"breadcrumb-item active","aria-current":"page"}," Detail ",-1),O={class:"fw-bold h1 mb-1"},U={class:"mb-0 text-muted text-end"},H={class:"h4 fw-bold text-end"},K={class:"row align-items-center"},F={class:"col-6"},R={class:"input-group my-3 bg-light rounded"},z={class:"input-group-prepend"},G=["disabled"],J=t("i",{class:"fas fa-minus fs-5"}," - ",-1),Q=[J],W={class:"input-group-append"},X=["disabled"],Y=t("i",{class:"fas fa-plus fs-5"}," + ",-1),Z=[Y],tt={class:"col-6"},st={class:"row my-5 col-12 justify-content-center"},ot={class:"col-md-6"},et={class:"col-md-4"},it={class:"text-muted"},ct={class:"row justify-content-center"},nt={class:"col-md-10"},dt={class:"row justify-content-between mt-4"},rt=t("h3",{class:"fw-bold"},"你可能還喜歡...",-1),at={class:"mb-4 position-relative position-relative"},lt=["src"],ut={class:"card-body p-0 d-flex justify-content-between align-items-end"},pt={class:"w-75"},_t={class:"mb-0 mt-3 fs-5"},ht={class:"card-text mb-0"},mt={class:"text-muted"},gt=["onClick"];function bt(c,s,i,ft,e,d){const y=f("LoadingView"),a=f("router-link");return p(),_("div",C,[t("div",q,[t("div",$,[r(y,{active:e.isLoading,"onUpdate:active":s[0]||(s[0]=o=>e.isLoading=o)},null,8,["active"]),t("div",V,[t("div",E,[t("div",I,[t("img",{src:e.product.imageUrl,class:"d-block w-100",alt:"productImage"},null,8,j)])])])]),t("div",B,[t("nav",S,[t("ol",A,[t("li",N,[r(a,{to:"/",class:"text-muted"},{default:u(()=>[h("Home")]),_:1})]),t("li",D,[r(a,{to:"/products",class:"text-muted"},{default:u(()=>[h("Product")]),_:1})]),M])]),t("h2",O,n(e.product.title),1),t("p",U,[t("del",null,"NT$"+n(e.product.origin_price),1)]),t("p",H," NT$"+n(e.product.price),1),t("div",K,[t("div",F,[t("div",R,[t("div",z,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1",onClick:s[1]||(s[1]=v(o=>d.qtyMinus(),["prevent"])),disabled:e.product.qty<=1},Q,8,G)]),w(t("input",{type:"number",class:"form-control border-0 text-center my-auto shadow-none bg-light","aria-label":"Example text with button addon","aria-describedby":"button-addon1","onUpdate:modelValue":s[2]||(s[2]=o=>e.product.qty=o)},null,512),[[T,e.product.qty]]),t("div",W,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2",onClick:s[3]||(s[3]=v(o=>d.qtyPlus(),["prevent"])),disabled:e.product.qty>=20},Z,8,X)])])]),t("div",tt,[t("button",{type:"button",class:"btn btn-primary py-2 text-nowrap w-100",onClick:s[4]||(s[4]=o=>d.addToCart(e.product.id))}," 加入購物車 ")])])])]),t("div",st,[t("div",ot,[t("p",null,n(e.product.description),1)]),t("div",et,[t("p",it,n(e.product.content),1)])]),t("div",ct,[t("div",nt,[t("div",dt,[rt,(p(!0),_(L,null,P(e.products,o=>(p(),_("div",{class:"col-md-4 mt-2",key:o.id},[t("div",at,[r(a,{to:`/product/${o.id}`,onClick:b=>d.goToProduct(o.id)},{default:u(()=>[t("img",{src:o.imageUrl,class:"card-img-top rounded-0",alt:"relativeProductImage",style:{"max-height":"150px","object-fit":"cover","object-position":"top center"}},null,8,lt)]),_:2},1032,["to","onClick"]),t("div",ut,[t("div",pt,[r(a,{to:`/product/${o.id}`,onClick:b=>d.goToProduct(o.id)},{default:u(()=>[t("h4",_t,n(o.title),1)]),_:2},1032,["to","onClick"]),t("p",ht,[h(" NT$"+n(o.price.toLocaleString())+" ",1),t("span",mt,[t("del",null,"NT$"+n(o.origin_price.toLocaleString()),1)])])]),t("button",{type:"button",class:"btn btn-outline-primary btn-sm text-nowrap",onClick:b=>d.addToCart(o.id)}," 加入購物車 ",8,gt)])])]))),128))])])])])}const xt=x(k,[["render",bt]]);export{xt as default};
